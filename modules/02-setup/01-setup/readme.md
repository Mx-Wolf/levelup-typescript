# Установка typescript

## Перед установкой

 TypeScript  это и дополнительный инструмент и синтаксис языка. Он позволяет вашему текстовому редактору лучше понимать ваши намерения и помогает вам создавать и улучшать код с уверенностью, что результат будет исполняться везде, где исполняется javascript. Этот инструмент требует установки.

Мы с вами будем работать локально. Вам потребуется nodejs и npm. Авторы уверены, то эти вещи у вас уже под рукой. Если ставить некуда, а познакомиться с TypeScript хочется, это не беда. В интернете можно найти песочницу. О ней мы расскажем в следующем разделе.

## Начнем

1. Создайте директорию для практической работы. `mkdir level-up-typescript` и сделайте ее текущей  `cd level-up-typescript`
2. Инициализируйте npm package. `npm init -y`
3. Добавьте в список зависимостей http-server. `npm i -D http-server`
4. Создайте новый файл `index.html` и добавьте него обычный набор тэгов в соответствии с html5. Мы предлагаем такой вариант.

```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title> TypeScript  At Work</title>
</head>
<body></body>
</html>
```

Теперь вы можете запустить сервер `npx http-server -o` и убедиться, что закладка браузера имеет название ` TypeScript  At Work` и в браузере отображается пустая страница.

Остановите http-server.

Наконец-то мы подошли к установке typescript.

5. Добавьте в список зависимостей пакета typescript. `npm i -D typescript`

Команда `npx tsc --version` позволит вам убедиться, что все идет по плану.

6. Инициализируйте конфигурацию tsconfig.json. `npx tsc --init`

Вы заметите, что в вашей директории появился файл `tsconfig.json`. Откройте и изучите этот файл в редакторе.

7. В этом файле сначала нас интересует строка `"target": ` Измените ее на `"target": "ES2020",`
8. Далее найдите и раскоментарьте строку `"module":`, измените ее, чтобы она стала `"module": "ES2020"`
9. Далее найдите и раскоментарьте строку `"outDir":`, измените ее, чтобы она стала `"outDir": "./js"`
10. Чтобы закончить конфигурацию TypeScript добавьте в tsconfig.json, перед самой последней `}` ключ и значение `"include": ["./src"]`. У вас должен получиться файл как представлено ниже (без учета комментариев)

```json
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "ES2020",
    "sourceMap": true,
    "outDir": "./js",
    "esModuleInterop": true,
    "forceConsistentCasingInFileNames": true,
    "strict": true,
    "skipLibCheck": true
  },
"include": ["./src"]
}
```

Настало время испытаний.

11. Создайте вложенную папку `src`. Ту самую, которую мы ранее указали в tsconfig.json в предпоследней строке.
12. Создайте в папке src файл `index.ts` и добавьте в него обычные javascript инструкции. Мы предлагаем такие

```typescript
const helloElement = document.createElement("h1");
helloElement.innerText = "Движение вверх и вперед";
document.body.appendChild(helloElement);
```

13. выполните команду `npx tsc`. Она заставит TypeScript произвести компиляцию и вы увидите новую папку js, а в ней файл `index.js`
14. Отредактируйте index.html и добавьте в него строку с инструкцией загрузки скрипта `<script type="module" src="js/index.js"></script>` и перезагрузите браузер.

**Ваш первый код на TypeScript в этом курсе успешно выполнен!**

## Для тех, кто хочет разобраться

Файл tsconfig.json является важным элементом работы в контексте TypeScript. Более того именно наличие в директории файла tsconfig.json превращает эту папку и все ее содержимое в проект TypeScript. Этот файл (tsconfig.json) содержит указания на то какой файл (какие файлы) подлежат компиляции и перечисляет настройки для компилятора. 

Компиляция программы TypeScript выполняется вызовом компилятора tsc. 

* **tsc** - без параметров заставляет компилятор искать ближайший вышележащий файл tsconfig.json, начиная с текущей директории. 
* **tsc –p &lt;file-name>** заставляет компилятор считать проектом указанный файл. При этом другие, возможно, хранящиеся файлы tsconfig.json игнорируются 

Когда проект найден (или указан) компилятор исследует json-объект с настройками и использует найденные там флаги для создания результата. 

Файл *tsconfig.json* это json объект. В корне json объекта в tsconfig.json возможны свойства 

`extends` - содержит указание на один или несколько файлов с базовыми настройками 

`compilerOptions` - содержит объект с флагами для компилятора 

`files`  - содержит список файлов проекта. Эта настройка имеет смысл, если у вас небольшое количество файлов. 

`include` - содержит список файлов с указанием маски для отбора 

* `*` ноль или больше символов 
* `**/` любая вложенная папка 
* `?` любой символ 

`exclude` - содержит список файлов с указание маски, которые следует игнорировать и не включать в проект.

Файл tscofig.json может дополнять значения другого файла, что позволяет собрать в одном файле существенные настройки, и модифицировать их в зависимости от требуемого режима компиляции. 

Ключ compilerOptions может быть опущен, в этом случае используются значения флагов по умолчанию. Полный список флагов доступен https://www.typescriptlang.org/tsconfig 

## Кратко о выбранных флагах компилятора  

`"target": "ES2020"` - TypeScript может создавать различный код JavaScript. Как современный, так и очень древних форматов. Значением по умолчанию для этого флага является ES3. Вы будете выбирать значение этого флага, основываясь на том какой минимальный уровень окружения вы можете гарантировать для своего приложения. 

`"module": "ES2020"` - Устанавливает режим поиска и использования модулей. Для приложений под nodejs вам скорее всего подойдет commonjs. Мы будем использовать фичи современных браузеров и их загрузчики модулей, поэтому мы выбираем es2020. 

`"sourceMap": true` - Включает создание специальных файлов .js.map содержащих подсказки для отладчика для связи между исполняемым в браузере файлом js и оригинальным исходным кодом ts. 

`"outDir": "./js"` - Указывает компилятору место для сохранения результатов компиляции. По умолчанию компилятор сохраняет результаты в директории, где он нашел файл. В результате по умолчанию и файлы .ts и результаты .js и .js.map оказываются в одной и той же директории. Нам удобнее хранить их отдельно, и мы, за одно, укажем нашу папку в .gitignore. 

`"esModuleInterop": true` - Действие этого флага влияет на интерпретацию модулей созданных в commonjs /amd/umd. Мы будем использовать загрузку модулей силами браузера - этот флаг не оказывает на нас явного воздействия. 

`"forceConsistentCasingInFileNames": true` - этот флаг важен для совместной разработки и при запуске программы в разных операционных системах. Установка этого флага позволяет компилятору дополнительно проверить, что имя файла в ссылке import совпадает с именем файла на диске с учетом регистра 

`"strict": true` - этот флаг компилятора заставляет работать систему анализа типов на полную мощность, без послабления на случай “а я не знал, а я забыл”. 

`"skipLibCheck": true`  - этот флаг позволяет компилятору сэкономить время на проверке типов из node_modules 

Чтобы завершить настройки проекта в следующем разделе мы добавим файлы для git, eslint, и mocha.